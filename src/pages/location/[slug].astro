---
import Layout from '@layouts/Layout.astro';
import { SITE, SERVICES, CITIES } from '../../lib/site';

export function getStaticPaths() {
  // Explicit pages exist for these cities; exclude from dynamic route
  const EXPLICIT_CITIES = ['lexington-ky', 'nicholasville-ky', 'georgetown-ky', 'richmond-ky', 
    'frankfort-ky', 'versailles-ky', 'shelbyville-ky', 'somerset-ky', 'corbin-ky', 'london-ky', 'berea-ky'];
  
  return CITIES
    .filter(c => !EXPLICIT_CITIES.includes(c.slug))
    .map((c) => ({ params: { slug: c.slug }, props: { city: c } }));
}

const { city } = Astro.props;

const title = `${city.name}, KY Storm Damage Restoration | ${SITE.name}`;
const description = `Roofing insurance claims and 24/7 water damage restoration in ${city.name}, Kentucky. Documented inspections and fast response.`;
const canonical = `${SITE.url}/location/${city.slug}`;
---

<Layout title={title} description={description} canonical={canonical}>
  <section class="section-spacing">
    <div class="mx-auto max-w-5xl">
      <p class="text-xs font-semibold uppercase tracking-wider text-text-muted">Service Area</p>
      <h1 class="mt-2 text-4xl font-black text-navy-dark">{city.name}, Kentucky</h1>
      <p class="mt-3 max-w-2xl text-lg text-text-muted">
      We serve {city.name} with insurance-ready roof inspections, storm damage restoration, and emergency water mitigation.
      If you’re searching for <strong>{city.name} KY water damage restoration</strong> or <strong>insurance claim roof repair {city.name}</strong>, start here.
    </p>

      <div class="mt-8 flex flex-col gap-3 sm:flex-row">
        <a href="/request-inspection" class="btn-primary inline-flex items-center justify-center">
          Request a Free Inspection
        </a>
        <a href={`tel:${SITE.tel}`} class="inline-flex items-center justify-center rounded-lg border-2 border-navy px-6 py-3 text-base font-semibold text-navy hover:bg-navy/5 transition-colors">
          Call {SITE.phone}
        </a>
      </div>

      <div class="mt-12 grid gap-6 md:grid-cols-2">
        {SERVICES.map((s) => (
          <a href={`/services/${s.slug}`} class="card-base group p-6 hover:shadow-card-hover">
            <div class="text-lg font-bold text-navy group-hover:text-accent-red transition-colors">{s.name}</div>
            <p class="mt-2 text-sm text-text-muted">{s.short}</p>
            <div class="mt-4 text-sm font-semibold text-accent-red">View details →</div>
          </a>
        ))}
      </div>

      <div class="mt-12 card-base p-8">
      <h2 class="text-2xl font-bold text-slate-900 mb-6">Frequently Asked Questions</h2>
      <div class="grid gap-6 md:grid-cols-2">
        <div class="rounded-xl bg-bg-muted p-5 border border-border hover:shadow-card transition-all duration-200">
          <div class="font-bold text-navy-dark mb-3">Do you help with insurance claims in {city.name}?</div>
          <p class="text-sm text-text-muted">Yes—our process includes professional damage documentation, before/after photos, and an insurance-ready scope. We coordinate with adjusters to ensure fair compensation.</p>
        </div>
        <div class="rounded-xl bg-bg-muted p-5 border border-border hover:shadow-card transition-all duration-200">
          <div class="font-bold text-navy-dark mb-3">How fast can you respond to emergencies?</div>
          <p class="text-sm text-text-muted">For active leaks, flooding, or electrical hazards, call immediately. We aim for 60-minute response times to prevent secondary damage like mold and structural decay.</p>
        </div>
      </div>
    </div>

    <!-- LocalBusiness schema -->
    <script type="application/ld+json">
      {JSON.stringify({
        "@context":"https://schema.org",
        "@type":"LocalBusiness",
        "name": SITE.name,
        "url": SITE.url,
        "telephone": SITE.phone,
        "email": SITE.email,
        "areaServed": city.name + ", KY",
        "address": {
          "@type":"PostalAddress",
          "streetAddress":"616 W 3rd St, Lexington, KY 40508",
          "addressLocality":"Lexington",
          "addressRegion":"KY",
          "addressCountry":"US"
        }
      })}
    </script>
  </section>
</Layout>
